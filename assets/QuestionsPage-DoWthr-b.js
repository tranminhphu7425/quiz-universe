import{c as E,r as n,e as U,j as e,m as C,S as Z,_ as B}from"./index-DPoNP6NI.js";import{A as K}from"./arrow-right-Dc-7o7FI.js";import{C as W}from"./circle-check-BcbRYklI.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],J=E("circle-x",q);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],ee=E("layout-grid",Y);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],se=E("refresh-ccw",te),re=(d,l,a)=>{const x=d[l];return x?typeof x=="function"?x():Promise.resolve(x):new Promise((y,o)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(o.bind(null,new Error("Unknown variable dynamic import: "+l+(l.split("/").length!==a?". Note that variables only represent file names one level deep.":""))))})},ae="http://localhost:8080/api";function pe(){const[d,l]=n.useState({}),[a,x]=n.useState(!1),[y,o]=n.useState({}),{subjectId:c}=U(),[b,g]=n.useState([]),[i,v]=n.useState(!1),[ie,P]=n.useState(!0),[de,$]=n.useState(null),[oe,ce]=n.useState(""),[me,xe]=n.useState(!1),I=n.useRef(null),_=n.useRef(!1),[h,f]=n.useState(1);n.useEffect(()=>{console.log(c)},[c]);const z=()=>{if(!c)return;P(!0),$(null);const t=new AbortController;return(async()=>{try{const s=await fetch(`${ae}/questions/subject/${c}`,{signal:t.signal});if(!s.ok){const m=await s.text().catch(()=>"");throw new Error(m||`HTTP ${s.status}`)}const r=await s.json();g(Array.isArray(r)?r:[])}catch(s){if(s?.name==="AbortError")return;$(s?.message||"Không thể lấy dữ liệu từ API. Đang dùng dữ liệu cục bộ!");try{const r=await re(Object.assign({"../../assets/data/questionssubject4.json":()=>B(()=>import("./questionssubject4-wqTVpFT-.js"),[]),"../../assets/data/questionssubject5.json":()=>B(()=>import("./questionssubject5-C0v3SGCQ.js"),[])}),`../../assets/data/questionssubject${c}.json`,5);g(r.default??[])}catch{g([])}}finally{P(!1)}})(),()=>t.abort()};n.useEffect(z,[c]),n.useEffect(()=>{_.current||I.current?.scrollIntoView({behavior:"smooth",block:"start"})},[h]);const w=10,S=50;n.useRef(null);const k=b.length,u=Math.ceil(k/w),j=(h-1)*w,A=j+w,D=t=>t>=j&&t<A,Q=b.slice(j,A),T=Math.floor(j/S)*S,R=T+S,O=b.slice(T,R);new Set(Object.entries(d).filter(([,t])=>t!=null).map(([t])=>Number(t)));const F=(t,s)=>{const r=Math.floor(t/w)+1;r!==h?(_.current=!0,f(r),setTimeout(()=>{document.getElementById(`q-${s}`)?.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>{_.current=!1},300)},0)):document.getElementById(`q-${s}`)?.scrollIntoView({behavior:"smooth",block:"start"})},V=n.useMemo(()=>{if(!a)return 0;let t=0;for(const s of b){const r=d[s.id],m=s.options.find(p=>p.isCorrect);r&&m&&r===m.id&&(t+=1)}return t},[a,d,b]),G=()=>{l({}),x(!1)},X=n.useMemo(()=>Object.values(d).filter(t=>t!=null).length,[d]);return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900",children:[e.jsxs("section",{className:"relative  overflow-hidden",children:[e.jsx("div",{className:"absolute  inset-0 bg-gradient-to-r from-emerald-600 via-green-600 to-emerald-500 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900"}),e.jsxs("div",{className:"relative z-10 mx-auto flex max-w-7xl flex-col items-center gap-6 px-6 py-14 text-white md:flex-row md:justify-between",children:[e.jsxs(C.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:160,damping:18},children:[e.jsxs("div",{className:"mb-3 inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 text-xs font-semibold ring-1 ring-white/20 backdrop-blur",children:[e.jsx(Z,{className:"h-4 w-4"})," QuizUniverse • Làm trắc nghiệm"]}),e.jsxs("h1",{className:"text-[2rem] md:text-[2.6rem] font-black leading-tight",children:["Bộ câu hỏi ôn tập ",e.jsx("span",{className:"bg-gradient-to-r from-purple-500 via-pink-500 to-amber-500 bg-clip-text text-transparent",children:"ML021"})]}),e.jsx("p",{className:"mt-2 text-white/90",children:"Chọn đáp án cho từng câu. Nộp bài để xem điểm và lời giải."})]}),e.jsxs(C.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.05},className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("div",{className:"rounded-xl bg-white/10 px-4 py-2 text-sm ring-1 ring-white/20",children:["Tổng câu: ",e.jsx("b",{children:k})]}),e.jsxs("div",{className:"rounded-xl bg-white/10 px-4 py-2 text-sm ring-1 ring-white/20",children:["Trạng thái: ",e.jsx("b",{children:a?"Đã nộp":"Chưa nộp"})]}),e.jsxs("div",{className:"rounded-xl bg-white/10 px-4 py-2 text-sm ring-1 ring-white/20",children:["Đã làm: ",e.jsx("b",{children:X}),"/",k]})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("main",{className:" mx-auto max-w-5xl px-6 py-10",children:[e.jsx("div",{ref:I}),e.jsx("div",{className:"mb-6 flex flex-wrap items-center gap-3",children:a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mr-2 inline-flex items-center gap-2 rounded-full bg-emerald-50 px-4 py-2 text-emerald-700 ring-1 ring-emerald-200 dark:bg-emerald-900/20 dark:text-emerald-300 dark:ring-emerald-800",children:["Điểm: ",e.jsx("b",{children:V}),"/",e.jsx("b",{children:k})]}),e.jsxs("button",{onClick:G,className:"inline-flex items-center gap-2 rounded-full bg-slate-800 px-5 py-2.5 text-white shadow hover:brightness-110 dark:bg-slate-700",children:["Làm lại ",e.jsx(se,{className:"h-4 w-4"})]})]}):e.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center gap-2 rounded-full bg-emerald-600 px-5 py-2.5 text-white shadow hover:brightness-110",children:["Nộp bài ",e.jsx(K,{className:"h-4 w-4"})]})}),e.jsx("div",{className:"space-y-6",children:Q.map((t,s)=>e.jsx(le,{index:j+s+1,q:t,pickedOptionId:d[t.id]??null,onPick:r=>{l(m=>({...m,[t.id]:r})),o(m=>({...m,[t.id]:r}))},onClear:()=>{l(r=>({...r,[t.id]:null})),o(r=>({...r,[t.id]:null}))},showResult:a},t.id))}),e.jsxs("div",{className:"my-5 flex flex-wrap items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>f(t=>Math.max(1,t-1)),disabled:h===1,className:"rounded-lg border border-slate-200 px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-50 disabled:opacity-50 dark:border-slate-700 dark:text-slate-200 dark:hover:bg-slate-800",title:"Trang trước",children:"← Trước"}),Array.from({length:u},(t,s)=>s+1).filter(t=>Math.abs(t-h)<=2||t===1||t===u).reduce((t,s,r,m)=>{if(r>0){const p=m[r-1];typeof p=="number"&&typeof s=="number"&&s-p>1&&t.push("…")}return t.push(s),t},[]).map((t,s)=>typeof t=="string"?e.jsx("span",{className:"px-2 text-slate-400",children:"…"},`ellipsis-${s}`):e.jsx("button",{onClick:()=>f(t),className:`rounded-lg px-3 py-1.5 text-sm font-medium border
              ${t===h?"bg-emerald-600 text-white border-emerald-600":"border-slate-200 text-slate-700 hover:bg-slate-50 dark:border-slate-700 dark:text-slate-200 dark:hover:bg-slate-800"}`,title:`Trang ${t}`,children:t},t)),e.jsx("button",{type:"button",onClick:()=>f(t=>Math.min(u,t+1)),disabled:h===u,className:"rounded-lg border border-slate-200 px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-50 disabled:opacity-50 dark:border-slate-700 dark:text-slate-200 dark:hover:bg-slate-800",title:"Trang sau",children:"Sau →"}),e.jsxs("div",{className:"ml-auto text-sm text-slate-600 dark:text-slate-300",children:["Trang ",e.jsx("b",{children:h}),"/",e.jsx("b",{children:u})," • Câu ",e.jsx("b",{children:j+1}),"–",e.jsx("b",{children:Math.min(A,k)})," / ",k]})]})]}),e.jsx("div",{className:"absolute right-5 top-10 w-fit h-full",children:e.jsxs("div",{className:"sticky top-20 w-fit",children:[!i&&e.jsx("button",{type:"button",onClick:()=>v(!0),className:" z-40 grid h-12 w-12 place-items-center rounded-full bg-emerald-600 text-white shadow-lg hover:brightness-110","aria-label":"Mở danh sách câu hỏi",title:"Danh sách câu hỏi",children:e.jsx(ee,{className:"h-5 w-5"})}),i&&e.jsx("div",{className:"relative inset-0 z-50 h-3/4 my-auto bg-slate-50 dark:bg-slate-900",children:e.jsxs(C.div,{initial:{x:360},animate:{x:0},exit:{x:360},transition:{type:"tween",duration:.2},className:"right-0 top-0 h-full w-[320px] bg-white shadow-xl dark:bg-slate-900 border-l border-slate-200 dark:border-slate-800 p-4 flex flex-col",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200",children:"Danh sách câu hỏi"}),e.jsx("button",{className:"rounded-lg border border-slate-200 px-3 py-1 text-xs text-slate-700 hover:bg-slate-50 dark:border-slate-700 dark:text-slate-200 dark:hover:bg-slate-800",onClick:()=>v(!1),children:"Đóng"})]}),e.jsxs("div",{className:"mb-3 flex flex-wrap gap-2 text-xs",children:[e.jsx("span",{className:"inline-flex items-center gap-1 rounded-md border px-2 py-0.5 text-slate-600 dark:text-slate-300 border-slate-300 dark:border-slate-700",children:"Chưa làm"}),e.jsx("span",{className:"inline-flex items-center gap-1 rounded-md px-2 py-0.5 text-white bg-emerald-600",children:"Đã chọn"}),a&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inline-flex items-center gap-1 rounded-md px-2 py-0.5 text-white bg-emerald-500",children:"Đúng"}),e.jsx("span",{className:"inline-flex items-center gap-1 rounded-md px-2 py-0.5 text-white bg-rose-500",children:"Sai"})]})]}),e.jsx("div",{className:"grid grid-cols-5 gap-2 overflow-auto",children:O.map((t,s)=>{const r=T+s,m=r+1,p=d[t.id],L=p!=null;let N="";a&&L?N=t.options.find(H=>H.isCorrect)?.id===p?"bg-emerald-500 text-white":"bg-rose-500 text-white":L?N="bg-emerald-700 text-white ":N="border border-slate-300 text-slate-700 dark:text-slate-300 dark:border-slate-700";let M=N;return M==="border border-slate-300 text-slate-700 dark:text-slate-300 dark:border-slate-700"&&D(r)&&(M="bg-neutral-200 dark:bg-neutral-500"),e.jsx("button",{onClick:()=>F(r,t.id),className:`h-8 rounded-md text-sm font-semibold  ${M}  `,title:`Tới câu ${m}`,children:m},t.id)})}),e.jsx("div",{className:"mt-auto pt-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("button",{onClick:()=>f(t=>Math.max(1,t-1)),disabled:h===1,className:"rounded-md border border-slate-200 px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-50 disabled:opacity-50 dark:border-slate-700 dark:text-slate-200 dark:hover:bg-slate-800",children:"← Trước"}),e.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:["Trang ",e.jsx("b",{children:h}),"/",e.jsx("b",{children:u})]}),e.jsx("button",{onClick:()=>f(t=>Math.min(u,t+1)),disabled:h===u,className:"ml-auto rounded-md border border-slate-200 px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-50 disabled:opacity-50 dark:border-slate-700 dark:text-slate-200 dark:hover:bg-slate-800",children:"Sau →"})]})})]})})]})})]})]})}function le({index:d,q:l,pickedOptionId:a,onPick:x,onClear:y,showResult:o}){const c=l.options.find(i=>i.isCorrect),b=o&&a&&c&&a===c.id,g=o&&a&&c&&a!==c.id;return e.jsxs(C.div,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},viewport:{once:!0,amount:.2},transition:{type:"spring",stiffness:140,damping:16},className:"relative rounded-2xl border border-emerald-100 bg-white p-5 shadow-sm hover:shadow-md dark:border-slate-800 dark:bg-slate-900",children:[e.jsx("div",{id:`q-${l.id}`,className:"absolute -top-24"}),e.jsxs("div",{className:"mb-3 flex items-start justify-between gap-3",children:[e.jsxs("h3",{className:"text-base font-semibold text-slate-800 dark:text-slate-200",children:[e.jsx("span",{className:"mr-2 inline-flex h-6 w-6 items-center justify-center rounded-md bg-emerald-500/90 text-xs font-bold text-white",children:d}),e.jsx("span",{className:"whitespace-pre-line",children:l.stem})]}),o?b?e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-100 px-2 py-1 text-emerald-700 ring-1 ring-emerald-300 dark:bg-emerald-900/30 dark:text-emerald-300 dark:ring-emerald-800",children:[e.jsx(W,{className:"h-4 w-4"})," Đúng"]}):g?e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-rose-100 px-2 py-1 text-rose-700 ring-1 ring-rose-300 dark:bg-rose-900/30 dark:text-rose-300 dark:ring-rose-800",children:[e.jsx(J,{className:"h-4 w-4"})," Sai"]}):null:a!==null&&e.jsx("button",{type:"button",onClick:y,className:"rounded-lg border border-slate-200 px-3 py-1 text-xs font-medium text-slate-700 hover:bg-slate-50 dark:border-slate-700 dark:text-slate-200 dark:hover:bg-slate-800",title:"Xóa lựa chọn của câu này",children:"Xóa lựa chọn"})]}),e.jsx("div",{className:"mt-3 grid gap-2",children:l.options.slice().sort((i,v)=>(i.sortOrder??0)-(v.sortOrder??0)).map(i=>e.jsx(ne,{groupName:`q-${l.id}`,opt:i,checked:a===i.id,disabled:o,onChange:()=>x(i.id),reveal:o,isCorrect:i.isCorrect,isPicked:a===i.id},i.id))}),o&&l.explanation&&e.jsxs("div",{className:"mt-4 rounded-xl bg-amber-50 p-3 text-amber-900 ring-1 ring-amber-200 dark:bg-amber-900/20 dark:text-amber-200 dark:ring-amber-800",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Giải thích"}),e.jsx("p",{className:"mt-1 text-sm leading-relaxed",children:l.explanation})]})]})}function ne({opt:d,checked:l,disabled:a,onChange:x,reveal:y,isCorrect:o,isPicked:c,groupName:b}){const g=y?o?"correct":c?"wrong":"neutral":l?"active":"idle",i={idle:"border-slate-200 hover:border-emerald-300 dark:border-slate-700 dark:hover:border-emerald-700",active:"border-emerald-400 bg-emerald-50 ring-1 ring-emerald-300 dark:bg-emerald-900/20 dark:border-emerald-700 dark:ring-emerald-800",correct:"border-emerald-400 bg-emerald-50 ring-1 ring-emerald-300 dark:bg-emerald-900/20 dark:border-emerald-700 dark:ring-emerald-800",wrong:"border-rose-300 bg-rose-50 ring-1 ring-rose-300 dark:bg-rose-900/20 dark:border-rose-700 dark:ring-rose-800",neutral:"border-slate-200 dark:border-slate-700"};return e.jsxs("label",{className:`group flex cursor-pointer items-start gap-3 rounded-xl border p-3 transition ${i[g]}`,children:[e.jsx("input",{type:"radio",name:b,className:"mt-1 h-4 w-4 accent-emerald-800",checked:l,onChange:x,disabled:a}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-slate-800 dark:text-slate-200",children:[e.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-md bg-slate-100 text-slate-700 group-hover:bg-emerald-100 group-hover:text-emerald-800 dark:bg-slate-800 dark:text-slate-300 dark:group-hover:bg-emerald-900/30 dark:group-hover:text-emerald-300",children:d.label}),e.jsx("span",{children:d.content})]})})]})}export{pe as default};
