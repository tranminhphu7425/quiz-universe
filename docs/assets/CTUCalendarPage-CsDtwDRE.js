import{r as n,j as e,s as S,o as q}from"./index-DeFSDhfv.js";import{T as L}from"./trash-2-DULxah7N.js";const R=()=>{const[h,c]=n.useState(""),[x,i]=n.useState([]),[o,m]=n.useState(null),[u,g]=n.useState([]),[l,b]=n.useState([]),[p,y]=n.useState([]);n.useEffect(()=>{(async()=>{const r=await fetch("/quiz-universe/data/ket_qua_dkmh_full.json"),t=await fetch("/quiz-universe/data/ket_qua_dkmh_full1.json"),s=await r.json(),d=await t.json();s.push(...d),y(s)})()},[]),n.useEffect(()=>{if(h.trim()===""){i([]);return}const a=setTimeout(()=>{const r=h.toLowerCase(),t=p.filter(s=>{const d=s.data.data.hoc_phan_info;return d.dkmh_tu_dien_hoc_phan_ma.toLowerCase().includes(r)||d.dkmh_tu_dien_hoc_phan_ten_vn.toLowerCase().includes(r)});i(t)},500);return()=>clearTimeout(a)},[h,p]);const j=()=>{!o||u.some(r=>r.ma_request===o.ma_request)||(g(r=>[...r,o]),c(""),m(null))},v=a=>{g(r=>r.filter(t=>t.ma_request!==a))},N=(a,r)=>{b(t=>[...t.filter(d=>d.dkmh_tu_dien_hoc_phan_ma!==r.dkmh_tu_dien_hoc_phan_ma),r])},w=a=>{b(r=>r.filter(t=>t.dkmh_tu_dien_hoc_phan_ma!==a.data.data.hoc_phan_info.dkmh_tu_dien_hoc_phan_ma))};n.useEffect(()=>{console.log("Selected Classes:",l)},[l]);const C=a=>{if(!a)return[];if(a.includes("-")){const[r,t]=a.split("-").map(Number);return Array.from({length:t-r+1},(s,d)=>r+d)}return[Number(a)]},k=(a,r,t)=>t.find(s=>s.dkmh_thu_trong_tuan_ma-2!==r?!1:C(s.tiet_hoc).includes(a));return e.jsxs("div",{className:"min-h-screen bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-white transition-colors duration-300",children:[e.jsx("div",{className:"p-4 border-b bg-white border-gray-200 dark:bg-gray-800 dark:border-gray-700",children:e.jsx("div",{className:"flex justify-between items-center max-w-7xl mx-auto",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Sắp xếp thời khóa biểu học"})})}),e.jsxs("div",{className:"max-w-7xl mx-auto p-4 lg:p-6",children:[e.jsxs("div",{className:"mb-6 p-4 rounded-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Thêm học phần mới"}),e.jsxs("div",{className:"relative flex flex-col md:flex-row gap-4",children:[e.jsx("input",{type:"text",placeholder:"Tìm kiếm môn học",value:h,onChange:a=>{c(a.target.value),m(null)},className:"flex-1 p-2 border rounded dark:bg-gray-700 dark:text-white"}),e.jsx("button",{onClick:j,disabled:!o,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:"Thêm"}),x.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 bg-white dark:bg-gray-700 border rounded shadow z-10 max-h-64 overflow-y-auto",children:x.map(a=>{const r=a.data.data.hoc_phan_info;return e.jsxs("div",{onClick:()=>{m(a),c(`${r.dkmh_tu_dien_hoc_phan_ma} - ${r.dkmh_tu_dien_hoc_phan_ten_vn}`),i([])},className:"p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600",children:[e.jsx("div",{className:"font-medium",children:r.dkmh_tu_dien_hoc_phan_ma}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[r.dkmh_tu_dien_hoc_phan_ten_vn," • ",r.dkmh_tu_dien_hoc_phan_so_tin_chi," tín chỉ"]})]},a.ma_request)})})]})]}),e.jsxs("div",{className:"rounded-lg border bg-white border-gray-200 dark:bg-gray-800 dark:border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-xl font-bold",children:"1. Danh sách học phần theo KHHT"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700 text-left",children:e.jsx("tr",{children:["STT","Mã HP","Tên học phần","Nhóm","TC","Giảng viên","Xóa"].map(a=>e.jsx("th",{className:"p-3 font-medium",children:a},a))})}),e.jsx("tbody",{children:u.map((a,r)=>{const t=a.data.data.hoc_phan_info,s=a.data.data.data;return e.jsxs("tr",{className:`border-t border-gray-200 hover:bg-gray-50\r
                   dark:border-gray-700 dark:hover:bg-gray-700/50`,children:[e.jsx("td",{className:"p-3 text-center",children:r+1}),e.jsx("td",{className:"p-3 font-medium text-blue-700 dark:text-blue-400",children:t.dkmh_tu_dien_hoc_phan_ma}),e.jsx("td",{className:"p-3",children:t.dkmh_tu_dien_hoc_phan_ten_vn}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{className:`w-full p-2 border rounded\r
               dark:bg-gray-700 dark:border-gray-600 dark:text-white`,value:l?.find(d=>d.dkmh_tu_dien_hoc_phan_ma===t.dkmh_tu_dien_hoc_phan_ma)?.dkmh_nhom_hoc_phan_ma||"",onChange:d=>{const _=d.target.value;if(_===""){w(a);return}const f=a.data.data.data.find(T=>T.dkmh_nhom_hoc_phan_ma===_);f&&N(a,f)},children:[e.jsx("option",{value:"",children:"-- Chọn nhóm --"}),a.data.data.data.map(d=>e.jsxs("option",{value:d.dkmh_nhom_hoc_phan_ma,children:["Nhóm ",d.dkmh_nhom_hoc_phan_ma," • ",d.tiet_hoc," •"," ",d.dkmh_tu_dien_phong_hoc_ten]},d.key))]})}),e.jsx("td",{className:"p-3 text-center",children:t.dkmh_tu_dien_hoc_phan_so_tin_chi}),e.jsx("td",{className:"p-3 text-center",children:s.length}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{onClick:()=>v(a.ma_request),className:`p-2 rounded text-red-600 hover:bg-red-100\r
                       dark:text-red-400 dark:hover:bg-red-900/30`,children:e.jsx(L,{className:"w-4 h-4"})})})]},a.ma_request)})})]})})]}),e.jsxs("div",{className:"mt-8 rounded-lg border bg-white border-gray-200 dark:bg-gray-800 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-xl font-bold",children:"2. Thời khóa biểu học phần"})}),e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Thời khóa biểu"}),e.jsxs("div",{className:"flex items-center gap-2 bg-white dark:bg-gray-700 px-3 py-1 rounded-full",children:[e.jsx(S,{className:"w-4 h-4 cursor-pointer hover:text-blue-600 dark:hover:text-blue-400"}),e.jsx("span",{className:"font-medium",children:"Tháng 12.2025 - Tháng 1"}),e.jsx(q,{className:"w-4 h-4 cursor-pointer hover:text-blue-600 dark:hover:text-blue-400"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:"2025:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"Tuần →"}),e.jsx("button",{className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm hover:bg-gray-100 dark:hover:bg-gray-700",children:"Hôm nay"})]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[800px]",children:[e.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 font-medium text-center w-24",children:"Thời gian"}),["Thứ 2","Thứ 3","Thứ 4","Thứ 5","Thứ 6","Thứ 7","Chủ nhật"].map((a,r)=>e.jsx("th",{className:`p-3 font-medium text-center ${r===6?"bg-blue-50 dark:bg-blue-900/20":""}`,children:a},r))]})}),e.jsxs("tbody",{children:[[1,2,3,4,5].map(a=>e.jsxs("tr",{children:[e.jsxs("td",{className:"p-2 text-center text-sm font-medium border-r border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/30",children:["Tiết ",a]}),Array(7).fill(null).map((r,t)=>e.jsx("td",{className:"p-1 border border-gray-200 dark:border-gray-700 h-24",children:(()=>{const s=k(a,t,l);return s?e.jsxs("div",{className:"p-2 rounded w-full bg-green-100 dark:bg-green-900/30 border border-green-300 dark:border-green-700",children:[e.jsx("div",{className:"font-medium text-sm",children:s.dkmh_tu_dien_hoc_phan_ten_vn}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[s.dkmh_tu_dien_hoc_phan_ma," (",s.dkmh_nhom_hoc_phan_ma,")"]}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:s.dkmh_tu_dien_phong_hoc_ten})]}):null})()},t))]},a)),[6,7,8,9].map(a=>e.jsxs("tr",{children:[e.jsxs("td",{className:"p-2 text-center text-sm font-medium border-r border-gray-200 dark:border-gray-700 bg-yellow-50 dark:bg-yellow-900/10",children:["Tiết ",a]}),Array(7).fill(null).map((r,t)=>e.jsx("td",{className:"p-1 border border-gray-200 dark:border-gray-700 h-24",children:(()=>{const s=k(a,t,l);return console.log(s),s?e.jsxs("div",{className:"p-2 rounded w-full bg-green-100 dark:bg-green-900/30 border border-green-300 dark:border-green-700",children:[e.jsx("div",{className:"font-medium text-sm",children:s.dkmh_tu_dien_hoc_phan_ten_vn}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[s.dkmh_tu_dien_hoc_phan_ma," (",s.dkmh_nhom_hoc_phan_ma,")"]}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:s.dkmh_tu_dien_phong_hoc_ten})]}):null})()},t))]},a))]})]})})]})]})]})};export{R as default};
